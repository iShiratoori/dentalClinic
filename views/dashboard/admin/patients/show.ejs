<% layout('layouts/boilerplate') %>
<div class="row">
  <div class="col-lg-3 mb-3">
    <div class="card">
      <div class="d-flex flex-row justify-content-end">
        <div class="dropdown">
          <a class="btn text-dark" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-three-dots-vertical"></i>
          </a>
          <ul class="dropdown-menu me-2 border-light shadow-lg rounded-4">
            <li><a class="dropdown-item" href="/admin/dashboard/patients/<%=patient._id%>/edit">Edit</a></li>
            <li>
              <a class="dropdown-item" href="#" id="dropdownSubLink"><span class="me-3">Schedule</span> <span><i class="bi bi-chevron-right"></i></span></a>
              <ul class="dropdown-menu dropdown-submenu shadow-lg rounded-4" id="dropdown-submenu">
                <li>
                  <a class="dropdown-item" href="/admin/dashboard/patients/<%=patient._id%>/newAppointment">New Appointment</a>
                </li>
                <li>
                  <a class="dropdown-item" href="/admin/dashboard/patients/<%=patient._id%>/newTreatment">New Treatment</a>
                </li>
              </ul>
            </li>
            <li><a class="dropdown-item" href="#">Transfer</a></li>
            <li><a class="dropdown-item text-danger" href="#">Delete</a></li>
          </ul>
        </div>
      </div>
      <div class="card-body">
        <div class="row justify-content-between">
          <div class="col-xl-auto col-md-4">
            <div class="card-image"><img src="<%=patient.image.url %>" alt="" class="avatar avatar-4xl"></div>
            <div class="card-text"><strong><%=patient.name.firstName %> <%=patient.name.lastName %></strong></div>
          </div>
          <div class="col-xl-auto col-md-8">
            <div class="row">
              <div class="col-xl-12 col-md-8">
                <div class="row">
                  <div class="col-auto">
                    <p>Gender:</p>
                  </div>
                  <div class="col-auto">
                    <p><strong><%=patient.gender %></strong></p>
                  </div>
                </div>
              </div>
              <div class="col-xl-12 col-md-8">
                <div class="row">
                  <div class="col-auto">
                    <p>Age:</p>
                  </div>
                  <div class="col-auto">
                    <p><strong><%=patient.dob.getAge()%></strong></p>
                  </div>
                </div>
              </div>
              <div class="col-xl-12 col-md-8">
                <div class="row">
                  <div class="col-auto">
                    <p>Last visited:</p>
                  </div>
                  <div class="col-auto">
                    <p><strong>2 months ago</strong></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-body">
        <div class="m-2">
          <p class="h4">Notes</p>
        </div>
        <div class="mx-2">
          <div class="row">
            <div class="col-auto">
              <span class="btn btn-outline-success mb-2 rounded-5">back molar pain</span>
            </div>
            <div class="col-auto">
              <span class="btn btn-outline-success mb-2 rounded-5">teeh-13 sensitive</span>
            </div>
            <div class="col-auto">
              <span class="btn btn-outline-success mb-2 rounded-5">Tooth ace</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-9 mb-3 bg-white text-dark">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="general-tab" data-bs-toggle="tab" data-bs-target="#general-tab-pane" type="button" role="tab" aria-controls="general-tab-pane" aria-selected="true">General</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">History</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact-tab-pane" type="button" role="tab" aria-controls="contact-tab-pane" aria-selected="false">Payments</button>
      </li>
    </ul>
    <div class="tab-content" id="patientTabContent">
      <div class="tab-pane fade show active" id="general-tab-pane" role="tabpanel" aria-labelledby="general-tab" tabindex="0">
        <div class="m-3">
          <h4 class="my-4 text-primary"><strong> Personal Details</strong></h4>
          <div class="ms-3">
            <div class="row mb-2">
              <div class="col-xl-auto col-md-4 col-sm-12 mb-3 me-4">
                <p>First Name</p>
                <p><span class="h4"><%=patient.name.firstName %></span></p>
              </div>
              <div class="col-xl-auto col-md-4 col-sm-12 mb-3 me-4">
                <p>Last Name</p>
                <p><span class="h4"><%=patient.name.lastName %></span></p>
              </div>
              <div class="col-xl-auto col-md-4 col-sm-12 mb-3">
                <p>Date of birth</p>
                <p><span class="h4"><%=patient.dob.fullDate()%></span></p>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-auto">
                <p>Address</p>
                <% patient.address.forEach((address, i) => { %>
                <p><span class="h4"><%=address.getFullAddress %></span></p>
                <%  })  %>
              </div>
            </div>
            <p><span class="h4 text-primary"><strong>Contacts</strong></span></p>
            <div class="row mb-3">
              <div class="col-xl-auto col-md-4 col-sm-12 mb-3">
                <p>Phone Number</p>
                <p><span class="h4"><%=patient.contacts.phone %></span></p>
              </div>
              <div class="col-xl-auto col-md-4 col-sm-12 mb-3">
                <p>Email</p>
                <p><span class="h4"><%=patient.contacts.email %></span></p>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-auto">
                <p>Registered</p>
                <p><span class="h4"><%=patient.registered %></span></p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
        <div class="m-3">
          <div class="row">
            <h4 class="text-primary"><strong>Patient History</strong></h4>
            <div class="col-6">
              <ul class="list-group">
                <li class="list-group-item">A simple default list group item</li>
                <li class="list-group-item list-group-item-primary">A simple primary list group item</li>
                <li class="list-group-item list-group-item-secondary">A simple secondary list group item</li>
                <li class="list-group-item list-group-item-success">A simple success list group item</li>
                <li class="list-group-item list-group-item-danger">A simple danger list group item</li>
                <li class="list-group-item list-group-item-warning">A simple warning list group item</li>
                <li class="list-group-item list-group-item-info">A simple info list group item</li>
                <li class="list-group-item list-group-item-light">A simple light list group item</li>
                <li class="list-group-item list-group-item-dark">A simple dark list group item</li>
              </ul>
            </div>
          </div>
          <div class="row">
            <h4 class="my-4 text-primary"><strong>Appointment History</strong></h4>
            <div class="col-xl-12 col-md-12 col-sm-12 mb-3">
              <div class="table-responsive">
                <table class="table table-hover table-nowrap border">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Time</th>
                      <th>Type</th>
                      <th>Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% patient.appointments.forEach((appointment, i) =>{ %>
                    <tr class="bg-white-hover text-dark-hover">
                      <td>
                        <p><span class="h5"><%=appointment.getDate %> </span> </p>
                      </td>
                      <td> <%=appointment.getTime %> </td>
                      <td> <%=appointment.type %> </td>
                      <td> <%=appointment.status %> </td>
                    </tr>
                    <% }) %>
                  </tbody>
                </table>
              </div>
              <div class="card-footer border-0 mt-0"> <span class="text-muted text-sm">Showing <span class="text-primary fs-4"><%=patient.appointments.length%></span> out of <span class="text-primary fs-4"><%=patient.appointments.length%></span> Appointments</span> </div>
            </div>
          </div>
          <div class="row">
            <h4 class="my-4 text-primary"><strong>Medical History</strong></h4>
            <div class="col-xl-12 col-md-12 col-sm-12 mb-3">
              <p>Blood Group Type: <span class="h5">O+</span></p>
              <p>Type of allergic: <span class="h5">alergicA</span></p>
              <p>Diabits: <span class="h5">No</span></p>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
        <div class="m-3">
          <h4 class="my-4 text-primary"><strong>Transaction History</strong></h4>
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th>Card ending</th>
                  <th>Amount</th>
                  <th>Status</th>
                  <th>Date</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>**32</td>
                  <td>$123</td>
                  <td><button class="btn btn-warning"><strong>Pending</strong></button></td>
                  <td>12/12/2024</td>
                </tr>
                <tr>
                  <td>**32</td>
                  <td>$123</td>
                  <td><button class="btn"><strong>Completed</strong></button></td>
                  <td>12/12/2024</td>
                </tr>
                <tr>
                  <td>**32</td>
                  <td>$123</td>
                  <td><button class="btn btn-success"><strong>Due</strong></button></td>
                  <td>12/12/2024</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>