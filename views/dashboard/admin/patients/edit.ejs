<% layout('layouts/boilerplate') %>
<div class="row">
  <div class="col-4 offset-3">

    <% if(error && error.length) {%>
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <%= error %>
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <% } %>
    <div class="mt-3">
      <h1 class="title text-center">Updating patient</h1>
    </div>
    <div class="mt-5">
      <form action="/admin/dashboard/patients/<%=patient._id%>?_method=PUT" method="POST" novalidate class="validated-form" enctype="multipart/form-data">
        <div class="mb-3">
          <label class="form-label" for="title">Title</label>
          <select name="patient[name][title]" id="title" class="form-select" required>
            <% utils.titles.forEach((title, i) => {%>
            <option value="<%=title %>" <%= patient.name.title === title ? 'selected': '' %>><%=title %></option>
            <% })  %>
          </select>
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="name">Patient First Name</label>
          <input class="form-control" type="text" name="patient[name][firstName]" id="name" value="<%=patient.name.firstName %>" required>
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="name">Patient Last Name</label>
          <input class="form-control" type="text" name="patient[name][lastName]" id="name" value="<%=patient.name.lastName %>" required>
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="dob">Date of Birth</label>
          <input class="form-control" type="date" name="patient[dob]" id="dob" value="<%=patient.dob.getReverseDate() %>" required>
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="gender">Gender</label>
          <select name="patient[gender]" id="gender" class="form-select" required>
            <option value="" selected disabled hidden>Choose gender</option>
            <% utils.gender.forEach((gender, i) => {%>
            <option value="<%=gender %>" <%= patient.gender === gender ? 'selected': '' %>><%=gender %></option>
            <% })  %>
          </select>
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="address">Patient Address</label>
          <div>
            <input class="form-control mb-2" type="text" name="patient[address][addressL1]" id="address" placeholder="address line 1" value="<%=patient.address[0].addressL1 %>" required>
            <input class="form-control mb-2" type="text" name="patient[address][addressL2]" id="address" placeholder="address line 2">
            <input class="form-control mb-2" type="text" name="patient[address][postCode]" id="address" placeholder="Post Code" value="<%=patient.address[0].postCode %>" required>
            <input class="form-control mb-2" type="text" name="patient[address][country]" id="address" placeholder="Country name" value="<%=patient.address[0].country %>" required>
            <div class="valid-feedback">
              Looks good!
            </div>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="phone">Mobile</label>
          <input class="form-control" type="text" name="patient[contacts][phone]" id="phone" value="<%=patient.contacts.phone %>" required>
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="Email">Email</label>
          <input class="form-control" type="text" name="patient[contacts][email]" id="email" value="<%=patient.contacts.email %>" required>
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label" for="image">Profile image</label>
          <input type="file" name="profileImage" id="image" class="form-file-input">
          <div class="valid-feedback">
            Looks good!
          </div>
        </div>
        <div class="mb-3 d-flex justify-content-center">
          <button class="btn btn-success">Update patient</button>
        </div>
      </form>
    </div>
  </div>
</div>